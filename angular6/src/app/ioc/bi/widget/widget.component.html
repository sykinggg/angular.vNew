<!-- Content Wrapper. Contains page content -->
<!-- Content Wrapper. Contains page content -->
<!-- <div [innerHtml]="texthtml"></div>
<ng-template *ngIf="true">
    <div [innerHtml]="texthtml"></div>
</ng-template>
<ng-container *ngIf="true">
    <ng-content *ngIf="true" select="texthtml"></ng-content>
</ng-container> -->
<div class="row">
    <!-- [ngClass]="{'col-md-2': liteMode, 'col-md-3': !liteMode}" -->
    <div class="col-md-4">
        <!-- 树重构 -->
        <!-- <widget-tree></widget-tree> -->
        <!-- 树 -->
        <div class="container-fluid py-2 border" [ngClass]="{true:'collapsed-box'}[schema?true:false]">
            <div class="box-header with-border">
                <h1 class="d-inline h5">
                    <i class="fa fa-bar-chart-o" aria-hidden="true"></i>
                    {{'CONFIG.WIDGET.WIDGET'|translate}}
                </h1>
                <div class="float-right">
                    <i class="fa fa-info toolbar-icon" (click)="showInfo()" title="{{'COMMON.INFORMATION'|translate}}"></i>&nbsp;
                    <i class="fa fa-plus toolbar-icon" (click)="newWgt()" title="{{'COMMON.NEW'|translate}}"></i>&nbsp;
                    <i [ngClass]="{false: 'd-none'}[!liteMode?true:false]" class="fa fa-copy toolbar-icon" (click)="copyNode()" title="{{'COMMON.COPY'|translate}}"></i>
                    <i [ngClass]="{false: 'd-none'}[!liteMode?true:false]" class="fa fa-edit toolbar-icon" (click)="editNode()" title="{{'COMMON.EDIT'|translate}}"></i>
                    <i [ngClass]="{false: 'd-none'}[!liteMode?true:false]" class="fa fa-trash-alt toolbar-icon" (click)="deleteNode()" title="{{'COMMON.DELETE'|translate}}"></i>
                    <i class="fa fa-bars toolbar-icon" data-widget="collapse"></i>
                </div>
            </div>
            <div class="box-body">
                <input type="text" class="form-control" placeholder="Search" [(ngModel)]="keywords" (keyup)="searchObservable.next(keywords)" title="dsr:kylin ds:Bill wg:test">
                <div class="panel-body" style="padding: 10px 0px; overflow-x: auto; font-size: small; max-height: 45vh">
                    <!-- <div id="widgetTreeID" js-tree="treeConfig" should-apply="applyModelChanges()"[(ngModel)]="treeData" tree="treeInstance"
                         tree-events-obj="treeEventsObj"></div> -->
                    <tree-root #dataSetTree [nodes]="originalData" [options]="treeOptions" (initialized)="initializedTree()" (moveNode)="moveNode($event)">
                            </tree-root>
                </div>
            </div>
        </div>
        <!-- 数据源重构 -->
        <!-- <widget-dataSource [curWidget]="curWidget"></widget-dataSource> -->
        <!-- 树下方的数据源 -->
        <div class="container-fluid py-2 border" style="margin-top: 15px;" *ngIf="schema">
            <div class="box-header with-border">
                <h1 class="d-inline h5">
                    <i class="fa fa-cube" aria-hidden="true"></i>
                    {{'CONFIG.DATASET.DATASET'|translate}}
                </h1>
                <div class="float-right">
                    <a href="javascript:void(0);" class="mr-1" role="button" (click)="refreshSchema()">
                        <i class="fa fa-sync-alt" aria-hidden="true"></i>
                    </a>
                    <a href="javascript:void(0);" class="mr-1" role="button">
                        <i class="fa fa-bars" aria-hidden="true" data-widget="collapse"></i>
                    </a>
                </div>
            </div>
            <div class="clearfix"></div>
            <hr />
            
            <div class="box-body" style="padding: 10px 0px; overflow-x: auto; font-size: small;">
                <div class="tree tree-bg-dragout " style="overflow:auto; overflow-x: auto; border:none; min-height: 70vh; max-height: 79vh; margin-bottom: 0px;">
                    <!-- 维度列 -->
                    <ul style="padding-left: 5px" *ngIf="schema.dimension">
                        <li class="parent_li">
                            <span><img src="assets/images/board/schema/dimension.gif"><b>{{'CONFIG.DATASET.DIMENSION'|translate}}</b></span>
                            <ul>
                                <!-- |filter:filterDimension -->
                                <li *ngFor="let o of schema.dimension" 
                                    [ngClass]="{'parent_li': o&&o.type == 'level', 'd-none': (disKeysGroups.indexOf(o.id) + 1)}" 
                                    dnd-draggable [dragEnabled]="true"
                                    [dragData]="{data: o, type: 'dimension'}">
                                    <span>
                                        <!-- <i class="fa fa-caret-down"/> -->
                                        <img src="assets/images/board/schema/hierarchy.gif">
                                        {{o.alias}}
                                        {{o.column ? o.column + ' ('+o.column+')':o.column}}
                                    </span>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <!-- 指标列 -->
                    <ul style="padding-left: 5px" *ngIf="schema.measure">
                        <li class="parent_li">
                            <span>
                                <img src="assets/images/board/schema/measure.gif">
                                <b>{{'CONFIG.DATASET.MEASURE'|translate}}</b>
                            </span>
                            <ul>
                                <li *ngFor="let o of schema.measure"
                                    [ngClass]="{'d-none': (disKeysGroups.indexOf(o.id) + 1)}" 
                                    dnd-draggable [dragEnabled]="true"
                                    [dragData]="{data: o, type: 'measure'}">
                                    <span>
                                        <img src="assets/images/board/schema/bullet_red.png">
                                        {{o.alias?o.alias:o.column}}
                                    </span>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <!-- 可选表达式 -->
                    <ul style="padding-left: 5px" *ngIf="schema.selects">
                        <li class="parent_li">
                            <span><b>{{'CONFIG.DATASET.UNCLASSIFY'|translate}}</b></span>
                            <ul>
                                <!-- |filter:filterDimension -->
                                <li *ngFor="let o of schema.selects"
                                    [ngClass]="{'d-none': (disselect.indexOf(o.id) + 1)}" 
                                    dnd-draggable [dragEnabled]="true"
                                    [dragData]="{data: o, type: 'select'}">
                                    <span>
                                        <img src="assets/images/board/schema/bullet_red.png">{{o.column}}
                                    </span>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <!-- 过滤器 -->
                    <ul style="padding-left: 5px">
                        <li class="parent_li" *ngIf="false">
                            <span><img src="assets/images/board/schema/measure.gif"/><b>{{'CONFIG.COMMON.CUSTOM_EXPRESSION'|translate}}</b></span>
                            <i *ngIf="customDs" class="glyphicon glyphicon-plus" (click)="editExp()"></i>
                            <ul>
                                <!-- |filter:filterExpressions -->
                                <li *ngFor="let o of curWidget.expressions"
                                    [ngClass]="{'d-none': (disexp.indexOf(o.id) + 1)}" 
                                    dnd-draggable [dragEnabled]="true"
                                    [dragData]="{data: o, type: 'exp'}">
                                    <span>
                                        <img src="assets/images/board/schema/bullet_red.png">{{o.alias}}
                                    </span>
                                    <i class="fa fa-edit" (click)="editExp(o)" *ngIf="!isDsExpression(o)"></i>
                                    <i class="text-blue fa fa-info-circle" (click)="viewExp(o)"></i>
                                    <i class="fa fa-trash-alt" (click)="curWidget.expressions.splice($index, 1)" *ngIf="!isDsExpression(o)"></i>
                                </li>
                            </ul>
                        </li>
                
                        <li class="parent_li">
                            <span><img src="assets/images/board/schema/filter.png"/><b>{{'CONFIG.DATASET.FILTER'|translate}}</b></span>
                            <a href="javascript:void(0);" role="button" (click)="editFilterGroup()">
                                <i class="fa fa-plus" aria-hidden="true"></i>
                                <span class="sr-only">{{'COMMON.DELETE'|translate}}</span>
                            </a>
                            <ul>
                                <!-- |filter:filterFilterGroup -->
                                <li *ngFor="let o of curWidget.filterGroups"
                                    [ngClass]="{'d-none': (disFilterGroups.indexOf(o.group) + 1)}" 
                                    dnd-draggable [dragEnabled]="true"
                                    [dragData]="{data: o, type: 'filterGroups'}">
                                    <span>
                                        <img src="assets/images/board/schema/bullet_green.png">{{o.group}}</span>
                                    <i class="fa fa-edit" (click)="editFilterGroup(o)" *ngIf="!isDsFilter(o)"></i>
                                    <i class="fa fa-trash-alt" (click)="curWidget.filterGroups.splice($index, 1)" *ngIf="!isDsFilter(o)"></i>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- [ngClass]="{'col-md-10': liteMode, 'col-md-9': !liteMode}" -->
    <div style="padding-left: 0px;" class="col-md-8">
        <div class="box" [ngClass]="{false: 'd-none'}[optFlag == 'new' || optFlag == 'edit']">
            <div class="carousel-inner">
                <h2 class="d-inline h5">
                    <span class="username" style="margin-left: 0px;">{{widgetName}}</span>
                    <br>
                    <span class="description" style="margin-left: 0px;">{{getCurDatasetName()}}</span>
                </h2>
                <div class="float-right bg-success text-white rounded px-1 mb-3" [ngSwitch]="optFlag">
                    <span *ngSwitchCase="'edit'" class="label label-info">{{'COMMON.EDIT'|translate}}</span>
                    <span *ngSwitchCase="'new'" class="label label-danger">{{'COMMON.NEW'|translate}}</span>
                </div>
            </div>
            <div class="box-body" style="height: 66vh;">
                <div class="row">
                    <div class="col-md-12 form-horizontal">
                        <div [ngClass]="{'d-none': (liteMode && alerts.length == 0)}">
                            <div class="row" [ngClass]="{true: 'd-none'}[customDs ? true : false]">
                                <div class="col-md-12">
                                    <div class="form-group row">
                                        <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.DATASET'|translate}}</label>
                                        <div class="col-sm-10">
                                            <select class="form-control" [(ngModel)]="curWidget.datasetId" (change)="loadData()">
                                                <option *ngFor="let w of datasetList" [ngValue]="w.id">{{w.name}}</option>
                                            </select>
                                            <!-- <ui-select[(ngModel)]="curWidget.datasetId" on-select="loadData()">
                                                <ui-select-match>
                                                    {{$select.selected.name}}
                                                </ui-select-match>
                                                <ui-select-choices group-by="datasetGroup"
                                                                   repeat="w.id as w in datasetList | filter:{name : $select.search}">
                                                    {{w.name}}
                                                </ui-select-choices>
                                            </ui-select> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row" [ngClass]="{false: 'd-none'}[customDs ? true : false]">
                                <div class="col-md-12">
                                    <div class="form-group row">
                                        <label class="col-md-2 control-label">{{'CONFIG.WIDGET.DATA_SOURCE'|translate}}</label>
                                        <div class="col-md-10">
                                            <select class="form-control" [(ngModel)]="datasource"
                                                    (change)="changeDs()">
                                                <option *ngFor="let d of datasourceList" [ngValue]="d">{{d.name+' ('+d.type+')'}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row" [ngClass]="{false: 'd-none'}[customDs ? true : false]" [formGroup]="datasetFormGroup">
                                <div class="form-group col-md-12" [ngClass]="{false: 'd-none'}[(datasource&&datasource.name)?true:false]" 
                                    *ngFor="let input of params" sk-bi-input [input]="input" [form]="datasetFormGroup"></div>
                            </div>
                            <div class="row">
                                <div class="offset-md-2 col-md-10" *ngFor="let alert of alerts">
                                    <ngb-alert [type]="alert.type || 'warning'" (close)="closeAlert(alert)">
                                        {{alert.msg}}
                                    </ngb-alert>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group row">
                                        <div class="offset-sm-2 col-sm-2 col-md-3">
                                            <a class="btn btn-block btn-success" (click)="customDs=!customDs">
                                                <i class="fa fa-fw {{customDs?'fa-table':'fa-edit'}}"></i>{{(customDs?'CONFIG.WIDGET.EXIST_QUERY':'CONFIG.WIDGET.NEW_QUERY')|translate}}
                                            </a>
                                        </div>
                                        <div class="col-sm-2">
                                            <button type="button" class="btn btn-block btn-success" (click)="loadData()">
                                                {{'CONFIG.WIDGET.LOAD_DATA'|translate}}
                                            </button>
                                        </div>
                                        <div class="col-sm-2 col-md-3">
                                            <label>
                                                <input type="checkbox" [(ngModel)]="loadFromCache"> {{'CONFIG.WIDGET.FROM_CACHE'|translate}}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <hr/>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group row" [ngClass]="{'has-error': !(verify.widgetName || widgetName.length)}">
                                        <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.WIDGET_NAME'|translate}}</label>
                                        <div class="col-sm-10">
                                            <input id="widgetName" [(ngModel)]="widgetName" class="form-control" placeholder="{{'CONFIG.WIDGET.CATEGORY'|translate}}/{{'CONFIG.WIDGET.WIDGET_NAME'|translate}}"/>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.WIDGET_TYPE_NEW' | translate}}</label>
                                        <div class="col-sm-10">
                                            <select [(ngModel)]="widgetType" class="form-control">
                                                <option *ngFor="let a of widget_type_choiceArr" [ngValue]="a.code">{{a.name}}</option>
                                            </select>
                                        </div>
                                    </div> 
                                </div>
                            </div>
                        </div>
                        <div class="row" [ngClass]="{false: 'd-none'}[schema?true:false]">
                            <div class="col-md-12">
                                <div class="form-group row" style="margin-bottom: 0px">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.WIDGET_TYPE'|translate}}</label>
                                    <div class="col-sm-10 chart-type">
                                        <!--[(ngModel)]="curWidget.config.chart_type" -->
                                        <a *ngFor="let chart of chart_types" class="nav-item float-left"
                                            [popoverTitle]="chart.name"
                                            triggers="mouseenter:mouseleave"
                                            placement="bottom"
                                            [ngbPopover]="popContent"
                                            (click)="changeChart(chart.value)"
                                            [ngClass]="[chart_types_status[chart.value]] && curWidget.config && chart.value == curWidget.config.chart_type ? 'active':''">
                                            <ng-template #popContent>
                                                <span><b>{{chart.row}}</b>&nbsp;{{'CONFIG.WIDGET.ROW'|translate}}</span><br>
                                                <span><b>{{chart.column}}</b>&nbsp;{{'CONFIG.WIDGET.GROUP'|translate}}</span><br>
                                                <span><b>{{chart.measure}}</b>&nbsp;{{'CONFIG.WIDGET.VALUE'|translate}}</span>
                                            </ng-template>
                                            <i class="chart-type-icon {{chart.class}} "
                                                [ngClass]="{true:'',false:'disabled' }[chart_types_status[chart.value]?true:false]"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <!-- 区域列表 areaMap -->
                            <div class="form-group col-md-12" 
                                *ngIf="curWidget&&curWidget.config&&(curWidget.config.chart_type == 'areaMap' || curWidget.config.chart_type == 'chinaMap')">
                                <div class="row">
                                    <label class="col-sm-2 control-label"></label>
                                    <div class="col-md-10 row">
                                        <!--<div class="col-md-3">-->
                                            <!--<select class="form-control" [(ngModel)]="vm.country" ng-options="country.label for country in vm.countries">-->
                                                <!--<option  value="">&#45;&#45; 请选择国家 &#45;&#45;</option>-->
                                            <!--</select>-->
                                        <!--</div>-->
                                        <div class="col-md-3">
                                            <select class="form-control" [(ngModel)]="curWidget.config.province.code" (change)="setCities()">
                                                <option [ngValue]="''">选择省份/州</option>
                                                <option *ngFor="let province of provinces" [ngValue]="province.code">{{province.name}}</option>
                                            </select>
                                        </div>
                                        <!-- ng-init="setCities()" -->
                                        <div class="col-md-3" *ngIf="(cities.length>0)">
                                            <select class="form-control" [(ngModel)]="curWidget.config.city.code">
                                                <option [ngValue]="''">选择城市/县区</option>
                                                <option *ngFor="let city of cities" [ngValue]="city.code">{{city.name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- 列维 -->
                            <div class="form-group col-md-12" 
                                *ngIf="curWidget&&curWidget.config&&configRule[curWidget.config.chart_type]&&configRule[curWidget.config.chart_type].groups">
                                <div class="row">
                                    <label class="col-sm-2 control-label text-right">
                                        {{'CONFIG.WIDGET.GROUP'|translate}}
                                        <i class="fa fa-question-circle" title="{{helpMessage.column}}" [ngClass]="{false: 'd-none'}[helpMessage&&helpMessage.column?true:false]"></i>
                                    </label>
                                    <div class="col-sm-10">
                                        <!-- dnd-inserted="toKeysGroups(curWidget.config.groups,index,item,type)"
                                        dnd-allowed-types="['dimension','select','group','key','filter']" -->
                                        <div dnd-list="curWidget.config.groups"
                                                dnd-droppable (onDropSuccess)="toKeysGroups('groups',$event.dragData)"
                                                class="form-control" style="min-height: 35px;height: auto;padding: 0px"
                                                [ngClass]="{highlight: targetHighlight.column}">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.groups; let idx = index" 
                                                    dnd-draggable [dragData]="{data: o, type: 'groups', delList: curWidget.config.groups, delIdx: idx}"
                                                    class="btn-group" style="cursor: move;margin: 3px 3px;">
                                                <button type="button" class="btn btn-default btn-sm" style="cursor: move;"
                                                        (click)="delKeysGroups('groups', idx)">
                                                    {{o.level?'['+o.level+'].':''}}{{o.alias?o.alias:o.col}}
                                                </button>
                                                <button type="button" class="btn btn-default btn-sm"
                                                        (click)="editSort(o)">
                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o&&o.sort]"></span>
                                                </button>
                                                <button type="button" class="btn btn-default btn-sm"
                                                        (click)="editFilter(curWidget.config.groups,idx)">
                                                    <span class="fa fa-filter"></span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- 行维 -->
                            <div class="form-group col-md-12" 
                                *ngIf="curWidget&&curWidget.config&&configRule[curWidget.config.chart_type]&&configRule[curWidget.config.chart_type].keys">
                                <div class="row">
                                    <label class="col-sm-2 control-label text-right">
                                        {{'CONFIG.WIDGET.ROW'|translate}}
                                        <i class="fa fa-question-circle" title="{{helpMessage.row}}" [ngClass]="{false: 'd-none'}[helpMessage&&helpMessage.row?true:false]"></i>
                                    </label>
                                    <div class="col-sm-10">
                                        <!-- dnd-inserted="toKeysGroups(curWidget.config.keys,index,item,type)"
                                        dnd-allowed-types="['dimension','select','group','key','filter']" -->
                                        <div dnd-list="curWidget.config.keys"
                                                dnd-droppable (onDropSuccess)="toKeysGroups('keys',$event.dragData)"
                                                class="form-control" style="min-height: 35px;height: auto;padding: 0px"
                                                [ngClass]="{highlight: targetHighlight.row}">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <!-- dnd-draggable="o"
                                            dnd-effect-allowed="move"
                                            dnd-moved="curWidget.config.keys.splice(idx, 1)"
                                            dnd-type="'key'"
                                            dnd-dragstart="onDragstart('dimension')" dnd-dragend="onDragCancle()" -->
                                            <div *ngFor="let o of curWidget.config.keys, let idx = index"
                                                    dnd-draggable [dragData]="{data: o, type: 'keys', delList: curWidget.config.keys, delIdx: idx}"
                                                    class="btn-group" style="cursor: move;margin: 3px 3px;">
                                                <button type="button" class="btn btn-default btn-sm" style="cursor: move;"
                                                    (click)="delKeysGroups('keys', idx)">
                                                    {{o.level?'['+o.level+'].':''}}{{o.alias?o.alias:o.col}}
                                                </button>
                                                <button type="button" class="btn btn-default btn-sm"
                                                        (click)="editSort(o);cleanVSort();">
                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o&&o.sort]"></span>
                                                </button>
                                                <button *ngIf="curWidget.config.chart_type=='table'" type="button" class="btn btn-default btn-sm"
                                                        (click)="editAlign(o)">
                                                    <span class="fa" [ngClass]="{undefined:'fa-align-center','left':'fa-align-left','right':'fa-align-right'}[o&&o.align]"></span>
                                                </button>
                                                <button type="button" class="btn btn-default btn-sm"
                                                        (click)="editFilter(curWidget.config.keys,idx)">
                                                    <span class="fa fa-filter"></span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- 过滤 -->
                            <div class="form-group col-md-12" 
                                *ngIf="curWidget&&curWidget.config&&configRule[curWidget.config.chart_type]&&configRule[curWidget.config.chart_type].filters">
                                <div class="row">
                                    <label class="col-sm-2 control-label text-right">
                                        {{'CONFIG.WIDGET.FILTER'|translate}}
                                        <i class="fa fa-question-circle" title="{{helpMessage.filter}}" [ngClass]="{false: 'd-none'}[helpMessage&&helpMessage.filter?true:false]"></i>
                                    </label>
                                    <div class="col-sm-10">
                                        <!-- dnd-inserted="toKeysGroups(curWidget.config.filters,index,item,type);onDragCancle();"
                                        dnd-allowed-types="['dimension','select','group','key','filter','filterGroup']" -->
                                        <div dnd-list="curWidget.config.filters"
                                                dnd-droppable (onDropSuccess)="toKeysGroups('filters',$event.dragData)"
                                                class="form-control" style="min-height: 35px;height: auto;padding: 0px"
                                                [ngClass]="{highlight: targetHighlight.filter}">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.filters, let idx = index" 
                                                    dnd-draggable [dragData]="{data: o, type: 'filters', delList: curWidget.config.filters, delIdx: idx}"
                                                    class="btn-group" style="cursor: move;margin: 3px 3px;">
                                                <div *ngIf="o.group" class="btn-group">
                                                    <button type="button" class="btn btn-warning btn-sm" style="cursor: move;"
                                                            (click)="delKeysGroups('filters', idx)">
                                                        {{o.group}}
                                                    </button>
                                                    <button type="button" class="btn btn-warning btn-sm" *ngIf="!isDsFilter(o)"
                                                            (click)="editFilterGroup(o)">
                                                        <span class="fa fa-edit"></span>
                                                    </button>
                                                </div>
                                                <div *ngIf="!o.group" class="btn-group">
                                                    <!-- (click)="curWidget.config.selects.push(o.col);curWidget.config.filters.splice(idx, 1);" -->
                                                    <button type="button" class="btn btn-default btn-sm" style="cursor: move;"
                                                            (click)="curWidget.config.filters.splice(idx, 1);">
                                                        {{o.alias?o.alias:o.col}}
                                                    </button>
                                                    <button type="button" class="btn btn-default btn-sm"
                                                            (click)="editFilter(curWidget.config.filters,idx)">
                                                        <span class="fa fa-filter"></span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="curWidget&&curWidget.config" class="col-md-12" [ngSwitch]="curWidget.config.chart_type">
                                <!-- <chart-table-config 
                                    [changeChartStatus]="changeChartStatus" 
                                    [targetHighlight]="targetHighlight" 
                                    [curWidget]="curWidget"
                                    [editSort]="editSort"
                                    [cleanRowSort]="cleanRowSort"
                                    [cleanVSort]="cleanVSort"></chart-table-config> -->
                                <!-- 列表 -->
                                <div class="form-group row" *ngSwitchCase="'table'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                class="form-control" style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 拖动占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div on="o.type" [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group" ngbDropdown>
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;"
                                                                dnd-draggable="o" dnd-type="'exp'"
                                                                dnd-effect-allowed="move"
                                                                dnd-moved="curWidget.config.values[0].cols.splice($index, 1)"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editAlign(o)">
                                                            <span class="fa" [ngClass]="{undefined:'fa-align-center','left':'fa-align-left','right':'fa-align-right'}[o.align]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " id="chartTypeTable" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" ngbDropdownMenu aria-labelledby="chartTypeTable">
                                                            <li class="cursor-pointer">
                                                                <input type="text" class="input" [(ngModel)]="o.formatter"
                                                                        placeholder="{{'CONFIG.WIDGET.FORMATTER'|translate}}">
                                                            </li>
                                                            <li *ngIf="!isDsExpression(o)" class="cursor-pointer">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li class="cursor-pointer">
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                dnd-draggable="o" dnd-type="'col'"
                                                                dnd-effect-allowed="move"
                                                                dnd-moved="curWidget.config.values[0].cols.splice($index, 1)"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editAlign(o)">
                                                            <span class="fa" [ngClass]="{undefined:'fa-align-center','left':'fa-align-left','right':'fa-align-right'}[o.align]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                            ngbDropdownToggle id="chartTypeTableDefault">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" ngbDropdownMenu 
                                                            aria-labelledby="chartTypeTableDefault">
                                                            <li>
                                                                <input type="text" class="input" [(ngModel)]="o.alias"
                                                                        placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}">
                                                            </li>
                                                            <li>
                                                                <input type="text" class="input" [(ngModel)]="o.formatter"
                                                                        placeholder="{{'CONFIG.WIDGET.FORMATTER'|translate}}">
                                                            </li>
                                                            <li class="dropdown-submenu">
                                                                <a tabindex="-1" ngbDropdownToggle id="chartTypeTableDefault1">{{'CONFIG.WIDGET.AGGREGATE_TYPE'|translate}}</a>
                                                                <ul class="dropdown-menu" ngbDropdownMenu 
                                                                    aria-labelledby="chartTypeTableDefault1">
                                                                    <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                        <a>{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 折线图 -->
                                <div class="form-group row" *ngSwitchCase="'line'">
                                    <label class="col-sm-2 control-label text-right">
                                        {{'CONFIG.WIDGET.VALUE_AXIS'|translate}}
                                        <i class="fa fa-plus-square" title="{{'CONFIG.WIDGET.ADD_NEW_AXIS'|translate}}"
                                            (click)="add_value()" style="cursor: pointer;" [ngClass]="{'d-none': curWidget.config.values.length >= 2}"/>
                                    </label>
                                    <div class="col-sm-10" style="height: {{ curWidget.config.values.length * 45}}px">
                                        <table class="table table-bordered">
                                            <tr *ngFor="let v of curWidget.config.values">
                                                <td style="padding: 1px 3px">
                                                    <select class="form-control" [(ngModel)]="v.series_type" style="width: 150px; padding: 0px;">
                                                        <option *ngFor="let type of value_series_types" [ngValue]="type.value">{{type.name}}</option>
                                                    </select>
                                                </td>
                                                <td dnd-list="v.cols" 
                                                    dnd-droppable (onDropSuccess)="toCol(v.cols,v.cols.length,$event.dragData.data, $event.dragData.type)"
                                                    dnd-allowed-types="['measure','select','col','exp']"
                                                    [ngClass]="{highlight: targetHighlight.value}"
                                                    style="width: 100%; padding: 1px 3px">
                                                    <!-- 拖动占位 -->
                                                    <!-- <div class="dndPlaceholder sort-highlight"
                                                            style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                                    </div> -->
                                                    <div *ngFor="let o of v.cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                            dnd-effect-allowed="move"
                                                            dnd-moved="v.cols.splice($index, 1)" class="btn-group" style="margin: 3px 3px;">
                                                        <div [ngSwitch]="o.type">
                                                            <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                                <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="v.cols.splice($index, 1);">
                                                                    {{o.alias}}
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                                    <li *ngIf="!isDsExpression(o)">
                                                                        <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                                    </li>
                                                                    <li>
                                                                        <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div> -->
                                                            <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                                <button type="button"
                                                                        (click)="v.cols.splice($index, 1);"
                                                                        class="btn btn-default btn-sm" style="cursor: move;">
                                                                    {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                    ngbDropdownToggle id="chartTypeLine">
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeLine">
                                                                    <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                                    <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                        <a>{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                    <li (click)="editVFilter(o)">
                                                                        <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="padding: 1px 3px">
                                                    <span class="text-red" style="display: block;margin-top: 7px;">
                                                        <i class="fa fa-trash-alt" style="cursor: pointer;vertical-align: middle;"
                                                            (click)="deleteValue(v.cols);curWidget.config.values.splice($index, 1)"></i>
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <!-- 饼图 -->
                                <div class="form-group row" *ngSwitchCase="'pie'">
                                    <label class="col-sm-2 control-label text-right">
                                        {{'CONFIG.WIDGET.VALUE_AXIS'|translate}}
                                        <i class="fa fa-plus-square" title="{{'CONFIG.WIDGET.ADD_NEW_AXIS'|translate}}"
                                            (click)="add_pie_value()" style="cursor: pointer;" [ngClass]="{'d-none': curWidget.config.values.length >= 2}"/>
                                    </label>
                                    <div class="col-sm-10" style="'height: {{ curWidget.config.values.length * 45}}px'">
                                        <table class="table table-bordered">
                                            <tr *ngFor="let v of curWidget.config.values">
                                                <td style="padding: 1px 3px">
                                                    <select class="form-control" [(ngModel)]="v.series_type" style="width: 150px; padding: 0px;">
                                                        <option *ngFor="let type of value_pie_types" [ngValue]="type.value">{{type.name}}</option>
                                                    </select>
                                                </td>
                                                <td dnd-list="v.cols" 
                                                    dnd-droppable (onDropSuccess)="toCol(v.cols,v.cols.length,$event.dragData.data, $event.dragData.type)"
                                                    dnd-allowed-types="['measure','select','col','exp']"
                                                    [ngClass]="{highlight: targetHighlight.value}"
                                                    style="width: 100%; padding: 1px 3px">
                                                    <!-- 拖动占位 -->
                                                    <!-- <div class="dndPlaceholder sort-highlight"
                                                            style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                                    </div> -->
                                                    <div *ngFor="let o of v.cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                            dnd-effect-allowed="move"
                                                            dnd-moved="v.cols.splice($index, 1)" class="btn-group" style="margin: 3px 3px;">
                                                        <div [ngSwitch]="o.type">
                                                            <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                                <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="v.cols.splice($index, 1);">
                                                                    {{o.alias}}
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                                    <li *ngIf="!isDsExpression(o)">
                                                                        <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                                    </li>
                                                                    <li>
                                                                        <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div> -->
                                                            <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                                <button type="button"
                                                                        (click)="v.cols.splice($index, 1);"
                                                                        class="btn btn-default btn-sm" style="cursor: move;">
                                                                    {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                    ngbDropdownToggle id="chartTypePie">
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypePie">
                                                                    <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                                    <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                        <a>{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                    <li (click)="editVFilter(o)">
                                                                        <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="padding: 1px 3px">
                                                    <span class="text-red" style="display: block;margin-top: 7px;">
                                                        <i class="fa fa-trash-alt" style="cursor: pointer;vertical-align: middle;"
                                                            (click)="deleteValue(v.cols);curWidget.config.values.splice($index, 1)"></i>
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <!-- kpi -->
                                <div class="form-group row" *ngSwitchCase="'kpi'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 拖动占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                            ngbDropdownToggle id="chartTypeKpi">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeKpi">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a >{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a >{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 漏斗 funnel -->
                                <div class="form-group row" *ngSwitchCase="'funnel'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " >
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" >
                                                            <li *ngIf="!isDsExpression(o)" (click)="editExp(o)">
                                                                <a>{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                            ngbDropdownToggle id="chartTypeFunnel">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" ngbDropdownMenu aria-labelledby="chartTypeFunnel">
                                                            <li>
                                                                <input type="text" class="input" [(ngModel)]="o.alias"
                                                                        placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}">
                                                            </li>
                                                            <li class="dropdown-submenu">
                                                                <a tabindex="-1">{{'CONFIG.WIDGET.AGGREGATE_TYPE'|translate}}</a>
                                                                <ul class="dropdown-menu">
                                                                    <li *ngFor="let a of value_aggregate_types">
                                                                        <a (click)="o.aggregate_type=a.value">{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 桑基图 sankey -->
                                <div class="form-group row" *ngSwitchCase="'sankey'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                class="form-control" style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                ngbDropdownToggle id="chartTypeSankey">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeSankey">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types">
                                                                <a (click)="o.aggregate_type=a.value">{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 雷达 radar -->
                                <div class="form-group row" *ngSwitchCase="'radar'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                class="form-control" style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group">
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" role="menu">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types">
                                                                <a (click)="o.aggregate_type=a.value">{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 地图 map -->
                                <div class="form-group row" *ngSwitchCase="'map'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div dnd-list="curWidget.config.values[0].cols"
                                            dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                class="form-control" style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                id="chartTypeMap" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeMap">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 分散 scatter -->
                                <div class="form-group row" *ngSwitchCase="'scatter'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE_AXIS'|translate}}</label>
                                    <div class="col-sm-10">
                                        <table class="table table-bordered">
                                            <tr>
                                                <th style="width: 120px">{{'CONFIG.WIDGET.VALUE'|translate}}</th>
                                                <th style="width: 120px">{{'CONFIG.WIDGET.SIZE'|translate}}</th>
                                                <th style="width: 120px">{{'CONFIG.WIDGET.COLOR'|translate}}</th>
                                            </tr>
                                            <tr>
                                                <td *ngFor="let v of curWidget.config.values"
                                                    dnd-droppable (onDropSuccess)="toCol(v.cols,v.cols.length,$event.dragData.data, $event.dragData.type)"
                                                    dnd-list="v.cols" dnd-inserted="dndTransfer.toCol(v.cols,index,item,type)"
                                                    dnd-allowed-types="['measure','select','col','exp']"
                                                    dnd-drop="v.cols.length == 0 ? item:false"
                                                    [ngClass]="{highlight: targetHighlight.value}"
                                                    style="width: 33%; height: 40px;padding: 0px 5px;">
                                                    <div class="dndPlaceholder sort-highlight"
                                                        style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                                    </div>
                                                    <div *ngFor="let o of v.cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                        dnd-effect-allowed="move"
                                                        dnd-moved="v.cols.splice($index, 1)" class="btn-group" style="margin: 3px 3px;">
                                                        <div [ngSwitch]="o.type">
                                                            <!-- <div *ngSwitchCase="'exp'" class="btn-group">
                                                                <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="v.cols.splice($index, 1);">
                                                                    {{o.alias}}
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                                    <li *ngIf="!isDsExpression(o)">
                                                                        <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                                    </li>
                                                                    <li>
                                                                        <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div> -->
                                                            <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                                <button type="button"
                                                                        (click)="v.cols.splice($index, 1);"
                                                                        class="btn btn-default btn-sm" style="cursor: move;">
                                                                    {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        id="chartTypeScatter" ngbDropdownToggle>
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeScatter">
                                                                    <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                                    <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                        <a>{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                    <li (click)="editVFilter(o)">
                                                                        <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <!-- 计量 gauge -->
                                <div class="form-group row" *ngSwitchCase="'gauge'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                            dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                            dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                            dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                            dnd-allowed-types="['measure','select','col','exp']"
                                            [ngClass]="{highlight: targetHighlight.value}"
                                            style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                dnd-effect-allowed="move"
                                                dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                id="chartTypeGauge" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeGauge">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 标签云 wordCloud -->
                                <div class="form-group row" *ngSwitchCase="'wordCloud'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                id="chartTypeWordCloud" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeWordCloud">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 矩形树图 treeMap -->
                                <div class="form-group row" *ngSwitchCase="'treeMap'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown >
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                id="chartTypeTreeMap" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeTreeMap">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 区域地图 areaMap -->
                                <div class="form-group row" *ngSwitchCase="'areaMap'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div dnd-list="curWidget.config.values[0].cols"
                                            dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                            dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                            dnd-allowed-types="['measure','select','col','exp']"
                                            dnd-drop="curWidget.config.values[0].cols.length<1 ? item:false"
                                            [ngClass]="{highlight: targetHighlight.value}"
                                            class="form-control" style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                dnd-effect-allowed="move"
                                                dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                            id="chartTypeAreaMap" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu"  ngbDropdownMenu aria-labelledby="chartTypeAreaMap">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 热点图（日历）heatMapCalendar -->
                                <div class="form-group row" *ngSwitchCase="'heatMapCalendar'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                            id="chartTypeHeatMapCalendar" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu"ngbDropdownMenu aria-labelledby="chartTypeHeatMapCalendar">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 热点图（表格）heatMapTable -->
                                <div class="form-group row" *ngSwitchCase="'heatMapTable'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                                dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                dnd-allowed-types="['measure','select','col','exp']"
                                                [ngClass]="{highlight: targetHighlight.value}"
                                                style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                    style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                    dnd-effect-allowed="move"
                                                    dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                    style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                id="chartTypeHeatMapTable" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeHeatMapTable">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 水球图 liquidFill -->
                                <div *ngSwitchCase="'liquidFill'">
                                    <div class="form-group row">
                                        <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                        <div class="col-sm-10">
                                            <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                                    dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                                    dnd-drop="curWidget.config.values[0].cols.length == 0 ? item:false"
                                                    dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                                    dnd-allowed-types="['measure','select','col','exp']"
                                                    [ngClass]="{highlight: targetHighlight.value}"
                                                    style="min-height: 35px;height: auto;padding: 0px">
                                                <!-- 占位 -->
                                                <!-- <div class="dndPlaceholder sort-highlight"
                                                        style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                                </div> -->
                                                <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                        dnd-effect-allowed="move"
                                                        dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                        style="margin: 3px 3px;">
                                                    <div [ngSwitch]="o.type">
                                                        <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                            <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                                {{o.alias}}
                                                            </button>
                                                            <button type="button" class="btn btn-primary btn-sm "
                                                                    (click)="editSort(o);cleanRowSort(o);">
                                                                <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                            </button>
                                                            <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                                <span class="fa fa-edit"></span>
                                                            </button>
                                                            <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                                <li *ngIf="!isDsExpression(o)">
                                                                    <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                                </li>
                                                                <li>
                                                                    <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                </li>
                                                            </ul>
                                                        </div> -->
                                                        <div *ngSwitchDefault class="btn-group">
                                                            <button type="button"
                                                                    (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                    class="btn btn-default btn-sm" style="cursor: move;">
                                                                {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                            </button>
                                                            <button type="button" class="btn btn-default btn-sm "
                                                                    (click)="editSort(o);cleanRowSort(o);">
                                                                <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                            </button>
                                                            <button type="button" class="btn btn-default btn-sm "
                                                                    data-toggle="dropdown">
                                                                <span class="fa fa-edit"></span>
                                                            </button>
                                                            <ul class="dropdown-menu" role="menu">
                                                                <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                                <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                    <a>{{a.name+'('+o.col+')'}}</a>
                                                                </li>
                                                                <li (click)="editVFilter(o)">
                                                                    <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.STYLE'|translate}}</label>
                                        <div class="col-sm-10">
                                            <select class="form-control" [(ngModel)]="curWidget.config.values[0].style">
                                                <option *ngFor="let s of liquid_fill_style" [ngValue]="s.value">{{s.name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-sm-2 control-label"></label>
                                        <div class="col-sm-10">
                                            <button type="button" class="btn btn-info btn-sm" (click)="curWidget.config.animation=curWidget.config.animation == 'static'?'dynamic':'static';">
                                                {{'CONFIG.WIDGET.'+curWidget.config.animation|uppercase|translate}}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <!-- 对比图 contrast -->
                                <div class="form-group row" *ngSwitchCase="'contrast'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div class="form-control" dnd-list="curWidget.config.values[0].cols"
                                            dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                            dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                            dnd-allowed-types="['measure','select','col','exp']"
                                            [ngClass]="{highlight: targetHighlight.value}"
                                            style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                dnd-effect-allowed="move"
                                                dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)" (click)="editExp(o)">
                                                                <a>{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                id="chartTypeContrast" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" ngbDropdownMenu aria-labelledby="chartTypeContrast">
                                                            <li>
                                                                <input type="text" class="input" [(ngModel)]="o.alias"
                                                                    placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}">
                                                            </li>
                                                            <li class="dropdown-submenu">
                                                                <a tabindex="-1">{{'CONFIG.WIDGET.AGGREGATE_TYPE'|translate}}</a>
                                                                <ul class="dropdown-menu">
                                                                    <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                        <a>{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 中国地图（本地） chinaMap -->
                                <div class="form-group row" *ngSwitchCase="'chinaMap'">
                                    <label class="col-sm-2 control-label text-right">
                                        {{'CONFIG.WIDGET.VALUE_AXIS'|translate}}
                                        <i class="fa fa-plus-square" title="{{'CONFIG.WIDGET.ADD_NEW_AXIS'|translate}}"
                                           (click)="add_china_map_value()" style="cursor: pointer;" *ngIf="curWidget.config.values.length < 3"/>
                                    </label>
                                    <div class="col-sm-10" style="'height: {{ curWidget.config.values.length * 45}}px'">
                                        <table class="table table-bordered">
                                            <tr *ngFor="let v of curWidget.config.values">
                                                <td style="padding: 1px 3px">
                                                    <select class="form-control" [(ngModel)]="v.series_type" style="width: 150px; padding: 0px;">
                                                        <option *ngFor="let type of china_map_types" [ngValue]="type.value">{{type.name}}</option>
                                                    </select>
                                                </td>
                                                <td dnd-list="v.cols" dnd-inserted="dndTransfer.toCol(v.cols,index,item,type)"
                                                    dnd-droppable (onDropSuccess)="toCol(v.cols,v.cols.length,$event.dragData.data, $event.dragData.type)"
                                                    dnd-allowed-types="['measure','select','col','exp']"
                                                    [ngClass]="{highlight: targetHighlight.value}"
                                                    style="width: 100%; padding: 1px 3px">
                                                    <!-- 占位 -->
                                                    <!-- <div class="dndPlaceholder sort-highlight"
                                                         style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                                    </div> -->
                                                    <div *ngFor="let o of v.cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                         dnd-effect-allowed="move"
                                                         dnd-moved="v.cols.splice($index, 1)" class="btn-group" style="margin: 3px 3px;">
                                                        <div [ngSwitch]="o.type">
                                                            <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                                <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="v.cols.splice($index, 1);">
                                                                    {{o.alias}}
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                                    <li *ngIf="!isDsExpression(o)" (click)="editExp(o)">
                                                                        <a>{{'COMMON.EDIT'|translate}}</a>
                                                                    </li>
                                                                    <li (click)="editVFilter(o)">
                                                                        <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div> -->
                                                            <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                                <button type="button"
                                                                        (click)="v.cols.splice($index, 1);"
                                                                        class="btn btn-default btn-sm" style="cursor: move;">
                                                                    {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        id="chartTypeChinaMap" ngbDropdownToggle>
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeChinaMap">
                                                                    <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                                    <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                        <a>{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                    <li (click)="editVFilter(o)">
                                                                        <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="padding: 1px 3px">
                                                    <span class="text-red" style="display: block;margin-top: 7px;">
                                                        <i class="fa fa-trash-alt" style="cursor: pointer;vertical-align: middle;"
                                                           (click)="deleteValue(v.cols);curWidget.config.values.splice($index, 1)"></i>
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <!-- 中国地图（百度）chinaMapBmap -->
                                <div class="form-group row" *ngSwitchCase="'chinaMapBmap'">
                                    <label class="col-sm-2 control-label text-right">
                                        {{'CONFIG.WIDGET.VALUE_AXIS'|translate}}
                                        <i class="fa fa-plus-square" title="{{'CONFIG.WIDGET.ADD_NEW_AXIS'|translate}}"
                                           (click)="add_china_map_value()" style="cursor: pointer;" *ngIf="curWidget.config.values.length < 3"/>
                                    </label>
                                    <div class="col-sm-10" style="'height: {{ curWidget.config.values.length * 45}}px'">
                                        <table class="table table-bordered">
                                            <tr *ngFor="let v of curWidget.config.values">
                                                <td style="padding: 1px 3px">
                                                    <select class="form-control" [(ngModel)]="v.series_type" style="width: 150px; padding: 0px;">
                                                        <option *ngFor="let type of china_map_types" [ngValue]="type.value">{{type.value}}</option>
                                                    </select>
                                                </td>
                                                <td dnd-list="v.cols" dnd-inserted="dndTransfer.toCol(v.cols,index,item,type)"
                                                    dnd-droppable (onDropSuccess)="toCol(v.cols,v.cols.length,$event.dragData.data, $event.dragData.type)"
                                                    dnd-allowed-types="['measure','select','col','exp']"
                                                    [ngClass]="{highlight: targetHighlight.value}"
                                                    style="width: 100%; padding: 1px 3px">
                                                    <!-- 占位 -->
                                                    <!-- <div class="dndPlaceholder sort-highlight"
                                                         style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                                    </div> -->
                                                    <div *ngFor="let o of v.cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                         dnd-effect-allowed="move"
                                                         dnd-moved="v.cols.splice($index, 1)" class="btn-group" style="margin: 3px 3px;">
                                                        <div [ngSwitch]="o.type">
                                                            <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                                <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="v.cols.splice($index, 1);">
                                                                    {{o.alias}}
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                                    <li *ngIf="!isDsExpression(o)" (click)="editExp(o)">
                                                                        <a>{{'COMMON.EDIT'|translate}}</a>
                                                                    </li>
                                                                    <li (click)="editVFilter(o)">
                                                                        <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div> -->
                                                            <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                                <button type="button"
                                                                        (click)="v.cols.splice($index, 1);"
                                                                        class="btn btn-default btn-sm" style="cursor: move;">
                                                                    {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        (click)="editSort(o);cleanRowSort(o);">
                                                                    <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-sm "
                                                                        id="chartTypeChinaMap" ngbDropdownToggle>
                                                                    <span class="fa fa-edit"></span>
                                                                </button>
                                                                <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeChinaMap">
                                                                    <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                                    <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                        <a>{{a.name+'('+o.col+')'}}</a>
                                                                    </li>
                                                                    <li (click)="editVFilter(o)">
                                                                        <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="padding: 1px 3px">
                                                    <span class="text-red" style="display: block;margin-top: 7px;">
                                                        <i class="fa fa-trash-alt" style="cursor: pointer;vertical-align: middle;"
                                                           (click)="deleteValue(v.cols);curWidget.config.values.splice($index, 1)"></i>
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <!-- 关系图 relation -->
                                <div class="form-group row" *ngSwitchCase="'relation'">
                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.VALUE'|translate}}</label>
                                    <div class="col-sm-10">
                                        <div dnd-list="curWidget.config.values[0].cols"
                                            dnd-droppable (onDropSuccess)="toCol(curWidget.config.values[0].cols,curWidget.config.values[0].cols.length,$event.dragData.data, $event.dragData.type)"
                                            dnd-inserted="dndTransfer.toCol(curWidget.config.values[0].cols,index,item,type)"
                                            dnd-allowed-types="['measure','select','col','exp']"
                                            dnd-drop="curWidget.config.values[0].cols.length<1 ? item:false"
                                            [ngClass]="{highlight: targetHighlight.value}"
                                            class="form-control" style="min-height: 35px;height: auto;padding: 0px">
                                            <!-- 占位 -->
                                            <!-- <div class="dndPlaceholder sort-highlight"
                                                style="height: 24px; width: 93px;margin: 3px 3px;display: inline-block;vertical-align: middle;">
                                            </div> -->
                                            <div *ngFor="let o of curWidget.config.values[0].cols" dnd-draggable="o" dnd-type="o.type=='exp'?'exp':'col'"
                                                dnd-effect-allowed="move"
                                                dnd-moved="curWidget.config.values[0].cols.splice($index, 1)" class="btn-group"
                                                style="margin: 3px 3px;">
                                                <div [ngSwitch]="o.type">
                                                    <!-- <div *ngSwitchCase="exp" class="btn-group">
                                                        <button type="button" class="btn btn-primary btn-sm" style="cursor: move;" (click)="curWidget.config.values[0].cols.splice($index, 1);">
                                                            {{o.alias}}
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-primary btn-sm " data-toggle="dropdown">
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                            <li *ngIf="!isDsExpression(o)">
                                                                <a (click)="editExp(o)">{{'COMMON.EDIT'|translate}}</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="editVFilter(o)">{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div> -->
                                                    <div *ngSwitchDefault class="btn-group" ngbDropdown>
                                                        <button type="button"
                                                                (click)="curWidget.config.values[0].cols.splice($index, 1);"
                                                                class="btn btn-default btn-sm" style="cursor: move;">
                                                            {{o.aggregate_type+'('+o.col+')'+ (o.alias?(' -> '+o.alias):'')}}
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                (click)="editSort(o);cleanRowSort(o);">
                                                            <span class="fa" [ngClass]="{undefined:'fa-sort','asc':'fa-sort-up','desc':'fa-sort-down'}[o.sort]"></span>
                                                        </button>
                                                        <button type="button" class="btn btn-default btn-sm "
                                                                id="chartTypeRelation" ngbDropdownToggle>
                                                            <span class="fa fa-edit"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu aria-labelledby="chartTypeRelation">
                                                            <li><input class="form-control" [(ngModel)]="o.alias" placeholder="{{'CONFIG.WIDGET.ALIAS'|translate}}"></li>
                                                            <li *ngFor="let a of value_aggregate_types" (click)="o.aggregate_type=a.value">
                                                                <a>{{a.name+'('+o.col+')'}}</a>
                                                            </li>
                                                            <li (click)="editVFilter(o)">
                                                                <a>{{'CONFIG.WIDGET.FILTER'|translate}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="margin: 10px 0px;">
                            <div class="col-md-12" style="padding: 0px">
                                <!-- Custom Tabs -->
                                <div class="nav-tabs-custom">
                                    <ul class="nav nav-tabs relactive">
                                        <li [ngClass]="{'active': tab=='preview_widget2'}">
                                            <a id="preview_widget_tab" (click)="preview()">Preview</a>
                                        </li>
                                        <li [ngClass]="{'active': tab=='viewQuery_widget'}">
                                            <a id="viewQuery_widget_tab" (click)="previewQuery()">Query</a>
                                        </li>
                                        <li [ngClass]="{'active': tab=='options'}">
                                            <a id="options_tab" (click)="setTab('options')">Option</a>
                                        </li>
                                        <li style="position: absolute; right: 0;">
                                            <button type="submit" (click)="preview()"
                                                    class="btn btn-success btn-sm">
                                                {{'CONFIG.WIDGET.PREVIEW'|translate}}
                                            </button>
                                            <button type="submit" (click)="previewQuery()"
                                                    class="btn btn-success btn-sm">
                                                {{'CONFIG.WIDGET.PREVIEW_QUERY'|translate}}
                                            </button>
                                            <button type="submit" (click)="saveWgt()"
                                                    class="btn btn-success btn-sm">
                                                {{'CONFIG.WIDGET.SAVE'|translate}}
                                            </button>
                                            <button type="submit" (click)="doCancel()"
                                                    class="btn btn-danger btn-sm">
                                                {{'CONFIG.WIDGET.CANCEL'|translate}}
                                            </button>
                                            <button type="submit" (click)="switchLiteMode()"
                                                    class="btn btn-info btn-sm">
                                                {{liteMode ? 'S' : 'L'}}
                                            </button>
                                        </li>
                                    </ul>
                                    <div class="tab-content" style="min-height: 43vh;">
                                        <!-- chartView 组件 -->
                                        <!-- <widget-chart-view [curWidget]="curWidget" [datasource]="datasource" [customDs]="customDs"></widget-chart-view> -->
                                        <div class="tab-pane active" id="preview_widget2" [ngClass]="{'d-none': tab!='preview_widget2'}"
                                             style="min-height: 300px;height: 100%;overflow: hidden;">
                                            <div [ngClass]="{'d-none': loadingPre?true:false}" id="preview_widget" style="min-height: 300px;"></div>
                                            <div class="overlay fa box box-solid" *ngIf="false" [ngClass]="{false: 'd-none'}[loadingPre?true:false]" style="min-height: 300px;">
                                                <div class="box-header">
                                                    <!--<h3 class="box-title"></h3>-->
                                                    <div class="box-tools pull-right">
                                                        <button type="button" class="btn btn-box-tool" data-widget="remove">
                                                            <i class="fa fa-times" style="font-size: large"></i></button>
                                                    </div>
                                                </div>
                                                <i class="fa fa-spinner fa-spin"></i>
                                            </div>
                                        </div>
                                        <div class="tab-pane active" id="viewQuery_widget" [ngClass]="{'d-none': tab!='viewQuery_widget'}"
                                             style="min-height: 300px;height: 100%;overflow: hidden; user-select: text;"></div>
                                        <!-- /.tab-pane ng-include="getOptionsView()" -->
                                        <div class="tab-pane active" id="options" [ngClass]="{'d-none': tab!='options'}"
                                            style="min-height: 300px;height: 100%;overflow: hidden;" *ngIf="curWidget&&curWidget.config" 
                                            [ngSwitch]="curWidget.config.chart_type">
                                            <!-- 折线图 -->
                                            <div class="row" *ngSwitchCase="'line'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <!--  href="#grid" -->
                                                        <li [ngClass]="{'active': optionLineType == 'grid'}" (click)="setOptionTab('grid')"><a>Grid</a></li>
                                                        <!--  href="#legend" -->
                                                        <li [ngClass]="{'active': optionLineType == 'legend'}" (click)="setOptionTab('legend')"><a>Legend</a></li>
                                                        <!--  href="#ctgAxis" -->
                                                        <li [ngClass]="{'active': optionLineType == 'ctgAxis'}" (click)="setOptionTab('ctgAxis')"><a>Category Axis</a></li>
                                                        <!--  href="#valAxis" -->
                                                        <li [ngClass]="{'active': optionLineType == 'valAxis'}" (click)="setOptionTab('valAxis')"><a>Value Axis</a></li>
                                                        <!--  href="#ext" -->
                                                        <li [ngClass]="{'active': optionLineType == 'ext'}" (click)="setOptionTab('ext')"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active col-wid-100" *ngIf="optionLineType == 'grid'" id="grid">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox"[(ngModel)]="curWidget.config.option.gridCustom"> Customize
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Top</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridTop"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Bottom</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridBottom"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Left</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridLeft"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Right</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridRight"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngIf="optionLineType == 'legend'" id="legend">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox"[(ngModel)]="curWidget.config.option.legendShow"> Show Legend
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">X</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendX" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="left">left</option>
                                                                                    <option value="right">right</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Y</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendY" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="top">top</option>
                                                                                    <option value="bottom">bottom</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Orient</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendOrient" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="horizontal">Horizontal</option>
                                                                                    <option value="vertical">Vertical</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngIf="optionLineType == 'ctgAxis'" id="ctgAxis">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Interval</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.ctgLabelInterval">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-6">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Rotate</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.ctgLabelRotate">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngIf="optionLineType == 'valAxis'" id="valAxis">
                                                            <div class="form-horizontal">
                                                                <div class="row" *ngFor="let v of curWidget.config.values">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label" style="padding: 7px 2px">{{$index}}-{{'CONFIG.WIDGET.AXIS_NAME'|translate}}</label>
                                                                            <div class="col-md-8">
                                                                                <input type="text" class="form-control"[(ngModel)]="v.name">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-3">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label" style="padding: 7px 2px">{{$index}}-Min</label>
                                                                            <div class="col-md-8">
                                                                                <input type="text" class="form-control"[(ngModel)]="v.min">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-3">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label" style="padding: 7px 2px">{{$index}}-Max</label>
                                                                            <div class="col-md-8">
                                                                                <input type="text" class="form-control"[(ngModel)]="v.max">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngIf="optionLineType == 'ext'" id="ext">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-4">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox"[(ngModel)]="curWidget.config.option.dataZoom"> Show DataZoom
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-md-4 control-label">Value Orient</label>
                                                                    <div class="col-md-8">
                                                                        <select class="form-control"[(ngModel)]="curWidget.config.valueAxis">
                                                                            <option value="both">Both</option>
                                                                            <option value="horizontal">Horizontal</option>
                                                                            <option value="vertical">Vertical</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 列表 -->
                                            <div class="row" *ngSwitchCase="'table'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <!-- href="#ext"  -->
                                                        <li class="active"><a data-toggle="tab">Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active" id="ext">
                                                            <div class="form-horizontal">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 饼图 -->
                                            <div class="row" *ngSwitchCase="'pie'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a href="#legend" data-toggle="tab">Legend</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active" id="legend">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox"[(ngModel)]="curWidget.config.option.legendShow"> Show Legend
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-4">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">X</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendX" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="left">left</option>
                                                                                    <option value="right">right</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Y</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendY" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="top">top</option>
                                                                                    <option value="bottom">bottom</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Orient</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendOrient" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="horizontal">Horizontal</option>
                                                                                    <option value="vertical">Vertical</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- kpi -->
                                            <div class="row" *ngSwitchCase="'kpi'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a href="#ext" data-toggle="tab">Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active" id="ext">
                                                            <div class="form-horizontal">
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.LABEL'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="text"[(ngModel)]="curWidget.config.values[0].name" class="form-control"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.FORMATTER'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="text"[(ngModel)]="curWidget.config.values[0].format" class="form-control"/>
                                                                        <span class="help-block">{{'CONFIG.WIDGET.EXAMPLE'|translate}}：'0,0.00' '0.00' '0%' '0.00%' ,<a
                                                                                href="http://numbrojs.com/format.html"
                                                                                target="_blank">{{'CONFIG.WIDGET.MORE'|translate}}</a> </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.STYLE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <select class="form-control"[(ngModel)]="curWidget.config.values[0].style">
                                                                            <option *ngFor="let s of kpi_styles" [ngValue]="s.value">{{s.name}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>                                                        
                                            </div>
                                            <!-- 漏斗funnel -->
                                            <div class="row" *ngSwitchCase="'funnel'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a data-toggle="tab">Legend</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active" id="legend">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox" [(ngModel)]="curWidget.config.option.legendShow"
                                                                                        ng-init="curWidget.config.option.legendShow ? null : curWidget.config.option.legendShow=true"> Show Legend
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-4">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">X</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control" [(ngModel)]="curWidget.config.option.legendX" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="left">left</option>
                                                                                    <option value="right">right</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Y</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control" [(ngModel)]="curWidget.config.option.legendY" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="top">top</option>
                                                                                    <option value="bottom">bottom</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Orient</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control" [(ngModel)]="curWidget.config.option.legendOrient" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="horizontal">Horizontal</option>
                                                                                    <option value="vertical">Vertical</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 桑基图sankey -->
                                            <div class="row" *ngSwitchCase="'sankey'">
                                                <div class="col-md-12">Not Supported</div>
                                            </div>
                                            <!-- 雷达 radar -->
                                            <div class="row" *ngSwitchCase="'radar'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li [ngClass]="{'active': optionLineType == 'grid'}" (click)="setOptionTab('grid')"><a>Legend</a></li>
                                                        <li [ngClass]="{'active': optionLineType == 'legend'}" (click)="setOptionTab('legend')"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active" *ngIf="optionLineType == 'grid'">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox" [(ngModel)]="curWidget.config.option.legendShow"
                                                                                        ng-init="curWidget.config.option.legendShow ? null : curWidget.config.option.legendShow=true"> Show Legend
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-4">
                                                                        <label class="col-md-4 control-label">X</label>
                                                                        <div class="col-md-8">
                                                                            <select class="form-control" [(ngModel)]="curWidget.config.option.legendX" [disabled]="!curWidget.config.option.legendShow">
                                                                                <option value="left">left</option>
                                                                                <option value="right">right</option>
                                                                                <option value="center">center</option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        <label class="col-md-4 control-label">Y</label>
                                                                        <div class="col-md-8">
                                                                            <select class="form-control" [(ngModel)]="curWidget.config.option.legendY" [disabled]="!curWidget.config.option.legendShow">
                                                                                <option value="top">top</option>
                                                                                <option value="bottom">bottom</option>
                                                                                <option value="center">center</option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        <label class="col-md-4 control-label">Orient</label>
                                                                        <div class="col-md-8">
                                                                            <select class="form-control" [(ngModel)]="curWidget.config.option.legendOrient" [disabled]="!curWidget.config.option.legendShow">
                                                                                <option value="horizontal">Horizontal</option>
                                                                                <option value="vertical">Vertical</option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active" *ngIf="optionLineType == 'legend'">
                                                            <div class="row">
                                                                <div class="form-group">
                                                                    <label class="col-md-4 control-label">Draw By</label>
                                                                    <div class="col-md-8">
                                                                        <select class="form-control" [(ngModel)]="curWidget.config.drawBy"
                                                                                ng-init="curWidget.config.drawBy ? null : curWidget.config.drawBy='column'">
                                                                            <option value="column">Column</option>
                                                                            <option value="row">Row</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 地图 map -->
                                            <div class="row" *ngSwitchCase="'map'">
                                                <div class="col-md-12">
                                                    Not Supported
                                                </div>
                                            </div>
                                            <!-- 分散 scatter -->
                                            <div class="row" *ngSwitchCase="'scatter'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <!--  href="#grid" -->
                                                        <li [ngClass]="{'active': optionLineType == 'grid'}" (click)="setOptionTab('grid')"><a>Grid</a></li>
                                                        <!--  href="#legend" -->
                                                        <li [ngClass]="{'active': optionLineType == 'legend'}" (click)="setOptionTab('legend')"><a>Legend</a></li>
                                                        <!--  href="#ctgAxis" -->
                                                        <li [ngClass]="{'active': optionLineType == 'ctgAxis'}" (click)="setOptionTab('ctgAxis')"><a>Category Axis</a></li>
                                                        <!--  href="#valAxis" -->
                                                        <li [ngClass]="{'active': optionLineType == 'valAxis'}" (click)="setOptionTab('valAxis')"><a>Value Axis</a></li>
                                                        <!--  href="#ext" -->
                                                        <li [ngClass]="{'active': optionLineType == 'ext'}" (click)="setOptionTab('ext')"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content" [ngSwitch]="optionLineType">
                                                        <div class="tab-pane active col-wid-100" *ngSwitchCase="'grid'" id="grid">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox"[(ngModel)]="curWidget.config.option.gridCustom"> Customize
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Top</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridTop"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Bottom</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridBottom"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Left</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridLeft"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-6 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Right</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.gridRight"
                                                                                            placeholder="Input 'n% ' or integer number as pixel" [disabled]="!curWidget.config.option.gridCustom">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngSwitchCase="'legend'" id="legend">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox"[(ngModel)]="curWidget.config.option.legendShow"> Show Legend
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">X</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendX" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="left">left</option>
                                                                                    <option value="right">right</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Y</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendY" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="top">top</option>
                                                                                    <option value="bottom">bottom</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label">Orient</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendOrient" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="horizontal">Horizontal</option>
                                                                                    <option value="vertical">Vertical</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngSwitchCase="'ctgAxis'" id="ctgAxis">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Interval</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.ctgLabelInterval">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-6">
                                                                        <div class="row">
                                                                            <label class="col-md-3 control-label">Rotate</label>
                                                                            <div class="col-md-7">
                                                                                <input type="text" class="form-control"[(ngModel)]="curWidget.config.option.ctgLabelRotate">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngSwitchCase="'valAxis'" id="valAxis">
                                                            <div class="form-horizontal">
                                                                <div class="row" *ngFor="let v of curWidget.config.values">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label" style="padding: 7px 2px">{{$index}}-{{'CONFIG.WIDGET.AXIS_NAME'|translate}}</label>
                                                                            <div class="col-md-8">
                                                                                <input type="text" class="form-control"[(ngModel)]="v.name">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-3">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label" style="padding: 7px 2px">{{$index}}-Min</label>
                                                                            <div class="col-md-8">
                                                                                <input type="text" class="form-control"[(ngModel)]="v.min">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-3">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label" style="padding: 7px 2px">{{$index}}-Max</label>
                                                                            <div class="col-md-8">
                                                                                <input type="text" class="form-control"[(ngModel)]="v.max">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngSwitchCase="'ext'" id="ext">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-4">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox" [(ngModel)]="curWidget.config.option.dataZoom" ng-init="curWidget.config.option.dataZoom=false"> Show DataZoom
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 计量 gauge -->
                                            <div class="row" *ngSwitchCase="'gauge'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a data-toggle="tab">Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active">
                                                            <form class="form-horizontal">
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.LABEL'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="text" [(ngModel)]="curWidget.config.values[0].name" [ngModelOptions]="{standalone: true}" class="form-control" />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.FORMATTER'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="text" [(ngModel)]="curWidget.config.values[0].format" [ngModelOptions]="{standalone: true}" class="form-control" />
                                                                        <span class="help-block">{{'CONFIG.WIDGET.EXAMPLE'|translate}}：'0,0.00' '0.00' '0%' '0.00%' ，
                                                                            <a href="http://numbrojs.com/format.html"target="_blank">{{'CONFIG.WIDGET.MORE'|translate}}</a> </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.MIN_VALUE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="number" [(ngModel)]="curWidget.config.values[0].minValue" [ngModelOptions]="{standalone: true}" placeholder="default value is 0" class="form-control" />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.MAX_VALUE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="number" [(ngModel)]="curWidget.config.values[0].maxValue" [ngModelOptions]="{standalone: true}" placeholder="default value is 100" class="form-control" />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.LINE_STYLE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <table class="table table-striped">
                                                                            <tr>
                                                                                <th style="width: 25px"></th>
                                                                                <th style="width: 120px">{{'CONFIG.WIDGET.STYLE_PROPORTION'|translate}}</th>
                                                                                <th style="width: 100px">{{'CONFIG.WIDGET.STYLE_COLOR'|translate}}</th>
                                                                            </tr>
                                                                            <tr *ngFor="let s of curWidget.config.styles">
                                                                                <td>
                                                                                    <span class="text-red" style="display: block;margin-top: 7px;">
                                                                                        <i class="fa fa-trash-alt" style="cursor: pointer;vertical-align: middle;"
                                                                                           (click)="deleteValue(v.cols);curWidget.config.styles.splice($index, 1)"></i>
                                                                                    </span>
                                                                                </td>
                                                                                <td>
                                                                                    <input type="text" [(ngModel)]="s.proportion" [ngModelOptions]="{standalone: true}" class="form-control input" style="width: 90%; padding: 6px 6px;"/>
                                                                                </td>
                                                                                <td>
                                                                                        <!-- ng-init="initColorPicker($index)" -->
                                                                                    <input type="text" id="color_{{$index}}" [(ngModel)]="s.color" [ngModelOptions]="{standalone: true}" class="form-control" style="width: 90%; padding: 6px 6px;"/>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <th colspan="4" style="text-align: center;">
                                                                                    <button type="button" class="btn btn-info btn-sm" (click)="add_style()">
                                                                                        {{'CONFIG.WIDGET.ADD_NEW_STYLE'|translate}}
                                                                                    </button>
                                                                                </th>
                                                                            </tr>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>                                                
                                            </div>
                                            <!-- 标签云 wordCloud -->
                                            <div class="row" *ngSwitchCase="'wordCloud'">
                                                <div class="col-md-12">Not Supported</div>
                                            </div>
                                            <!-- 矩形树图 treeMap -->
                                            <div class="row" *ngSwitchCase="'treeMap'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a data-toggle="tab">Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active">
                                                            <form class="form-horizontal">
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.LABEL'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="text" [(ngModel)]="curWidget.config.values[0].name" [ngModelOptions]="{standalone: true}" class="form-control" />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.LEAF_DEPTH'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <select class="form-control" [(ngModel)]="curWidget.config.values[0].leafDepth" [ngModelOptions]="{standalone: true}">
                                                                            <option *ngFor="let key of curWidget.config.keys" [ngValue]="curWidget.config.keys.indexOf(key)+1">{{curWidget.config.keys.indexOf(key)+1}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.STYLE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <select class="form-control" [(ngModel)]="curWidget.config.values[0].style" [ngModelOptions]="{standalone: true}">
                                                                            <option *ngFor="let s of treemap_styles" [ngValue]="s.value">{{s.name}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 区域地图 areaMap -->
                                            <div class="row" *ngSwitchCase="'areaMap'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a data-toggle="tab">Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active">
                                                            <form class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-4">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <!-- ng-init="curWidget.config.option.hasSuffix=true" -->
                                                                                <input type="checkbox" value="false" [ngModelOptions]="{standalone: true}" [(ngModel)]="curWidget.config.option.hasSuffix"> 是否带行政单位
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 热点图（日历）heatMapCalendar -->
                                            <div class="row" *ngSwitchCase="'heatMapCalendar'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active">
                                                            <form class="form-horizontal">
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.STYLE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <select class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="curWidget.config.values[0].style">
                                                                            <option *ngFor="let s of heatmap_styles" [ngValue]="s.value">{{s.name}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.DATE_FORMAT'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <select class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="curWidget.config.values[0].dateFormat">
                                                                            <option *ngFor="let s of heatmap_date_format" [ngValue]="s.value">{{s.name}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 热点图（表格）heatMapTable -->
                                            <div class="row" *ngSwitchCase="'heatMapTable'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active">
                                                            <form class="form-horizontal">
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.STYLE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <select class="form-control" [(ngModel)]="curWidget.config.values[0].style" [ngModelOptions]="{standalone: true}">
                                                                            <option *ngFor="let s of heatmap_styles" [ngValue]="s.value">{{s.name}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 水球图 liquidFill -->
                                            <div class="row" *ngSwitchCase="'liquidFill'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active" >
                                                            <form class="form-horizontal">
                                                                <div class="form-group row">
                                                                    <label class="col-sm-2 control-label text-right">{{'CONFIG.WIDGET.MAX_VALUE'|translate}}</label>
                                                                    <div class="col-sm-10">
                                                                        <input type="number" [(ngModel)]="curWidget.config.values[0].maxValue" value="100.0" placeholder="default value is 100" class="form-control" />
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 对比图 contrast -->
                                            <div class="row" *ngSwitchCase="'contrast'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active" [ngClass]="{'active': optionLineType == 'legend'}" (click)="setOptionTab('legend')"><a>Legend</a></li>
                                                        <li [ngClass]="{'active': optionLineType == 'ext'}" (click)="setOptionTab('ext')"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active col-wid-100" *ngIf="optionLineType == 'legend'">
                                                            <div class="form-horizontal">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <div class="checkbox">
                                                                            <label>
                                                                                <input type="checkbox"[(ngModel)]="curWidget.config.option.legendShow"> Show Legend
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label text-right">X</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendX" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="left">left</option>
                                                                                    <option value="right">right</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label text-right">Y</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendY" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="top">top</option>
                                                                                    <option value="bottom">bottom</option>
                                                                                    <option value="center">center</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-md-4 col-wid-100">
                                                                        <div class="row">
                                                                            <label class="col-md-4 control-label text-right">Orient</label>
                                                                            <div class="col-md-8">
                                                                                <select class="form-control"[(ngModel)]="curWidget.config.option.legendOrient" [disabled]="!curWidget.config.option.legendShow">
                                                                                    <option value="horizontal">Horizontal</option>
                                                                                    <option value="vertical">Vertical</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tab-pane active col-wid-100" *ngIf="optionLineType == 'ext'">
                                                            <div class="form-group row">
                                                                <label class="col-md-4 control-label text-right">Value Orient{{curWidget.config.valueAxis}}</label>
                                                                <div class="col-md-8">
                                                                    <select class="form-control" [(ngModel)]="curWidget.config.valueAxis"
                                                                            ng-init="curWidget.config.valueAxis ? null : curWidget.config.valueAxis='vertical'">
                                                                        <option value="horizontal">Horizontal</option>
                                                                        <option value="vertical">Vertical</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- 中国地图（本地） chinaMap -->
                                            <div class="row" *ngSwitchCase="'chinaMap'">
                                                <div class="col-md-12">Not Supported</div>
                                            </div>
                                            <!-- 中国地图（百度）chinaMapBmap -->
                                            <div class="row" *ngSwitchCase="'chinaMapBmap'">
                                                <div class="col-md-12">Not Supported</div>
                                            </div>
                                            <!-- 关系图 relation -->
                                            <div class="row" *ngSwitchCase="'relation'">
                                                <div class="col-xs-3 col-md-2">
                                                    <!-- Nav tabs -->
                                                    <ul class="nav nav-tabs tabs-left"><!-- 'tabs-right' for right tabs -->
                                                        <li class="active"><a>Ext</a></li>
                                                    </ul>
                                                </div>
                                                <div class="col-xs-9 col-md-10">
                                                    <!-- Tab panes -->
                                                    <div class="tab-content">
                                                        <div class="tab-pane active">
                                                            <form class="form-horizontal">
                                                                <div class="form-group">
                                                                    <label class="col-sm-2 control-label">{{'CONFIG.WIDGET.NODE_PROPORTION'|translate}}</label>
                                                                    <div class="col-sm-5">
                                                                        <input type="text" [(ngModel)]="curWidget.config.option.nodeProportion" class="form-control"
                                                                               placeholder="0.1~10"/>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- /.tab-pane -->
                                    </div>
                                    <!-- /.tab-content -->
                                </div>
                                <!-- nav-tabs-custom -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="box-footer">
            </div>
            <div class="overlay fa box box-solid" *ngIf="false" [ngClass]="{false: 'd-none'}[loading?true:false]">
                <div class="box-header with-border">
                    <!--<h3 class="box-title"></h3>-->
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="remove">
                            <i class="fa fa-times" style="font-size: large"></i></button>
                    </div>
                </div>
                <i class="fa fa-spinner fa-spin"></i>
            </div>
        </div>
    </div>
</div>
</div>
<script type="text/ng-template" id="widgetTipTemplate">
    <span><b>{{chart.row}}</b> &nbsp; {{'CONFIG.WIDGET.TIPS_ROW_DIM'|translate}} </span><br/>
    <span><b>{{chart.column}}</b> &nbsp; {{'CONFIG.WIDGET.TIPS_COLUMN_DIM'|translate}} </span><br/>
    <span><b>{{chart.measure}}</b> &nbsp; {{'CONFIG.WIDGET.TIPS_MEASURE'|translate}} </span><br/>
</script>