{"version":3,"sources":["src/chart/chartKpi.service.ts"],"names":[],"mappings":";;;AAAA,sCAA2C;AAG3C,IAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC/B,4CAAuD;AAEvD,gEAAoE;AACpE,wDAAwD;AACxD,IAAI,WAAW,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AAIzC;IACI,yBACY,SAA2B,EAC3B,eAAuC;QADvC,cAAS,GAAT,SAAS,CAAkB;QAC3B,oBAAe,GAAf,eAAe,CAAwB;IAChD,CAAC;IAEG,gCAAM,GAAb,UAAc,YAAY,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO;QAC9C,IAAI,MAAM,GAAQ,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;QAC7E,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAChC,IAAI,KAAK,EAAE;YACP,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;SAC9C;aAAM;YACH,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC3B;QACD,OAAO,MAAM,CAAC,cAAc,EAAE,CAAC;IACnC,CAAC;IAAA,CAAC;IAEK,qCAAW,GAAlB,UAAmB,IAAI;QACnB,IAAI,MAAM,GAAQ,EAAE,CAAC;QACrB,IAAI,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC;QAC9B,IAAI,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC;QAC5B,IAAI,aAAa,GAAG,IAAI,CAAC,MAAM,CAAC;QAChC,IAAI,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC;QAC/B,IAAI,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC;QAExC,MAAM,CAAC,QAAQ,GAAG,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QAC3E,IAAI,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;YACzB,MAAM,CAAC,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;SAC7E;QACD,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACvC,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QACtC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;QACpD,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;QAC1D,OAAO,MAAM,CAAC;IAClB,CAAC;IAAA,CAAC;IAlCO,eAAe;QAF3B,iBAAU,EAAE;iDAIc,uBAAgB;YACV,0CAAsB;OAH1C,eAAe,CAmC3B;IAAD,sBAAC;CAnCD,AAmCC,IAAA;AAnCY,0CAAe","file":"../../../src/chart/chartKpi.service.js","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport * as _ from 'lodash';\r\nimport { Router } from '@angular/router';\r\nvar numbro = require(\"numbro\");\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\nimport { CBoardKpiRenderService } from './render/kpiRender.service';\r\n// import { CBoardKpiRender } from './render/kpiRender';\r\nvar html2canvas = require('html2canvas');\r\n\r\n@Injectable()\r\n\r\nexport class ChartKpiService{\r\n    constructor(\r\n        private translate: TranslateService,\r\n        private cBoardKpiRender: CBoardKpiRenderService\r\n    ) {}\r\n\r\n    public render(containerDom, option, scope, persist) {\r\n        var render: any = this.cBoardKpiRender.CBoardKpiRender(containerDom, option);\r\n        var html = render.html(persist);\r\n        if (scope) {\r\n            containerDom.append($compile(html)(scope));\r\n        } else {\r\n            containerDom.html(html);\r\n        }\r\n        return render.realTimeTicket();\r\n    };\r\n\r\n    public parseOption(data) {\r\n        var option: any = {};\r\n        var config = data.chartConfig;\r\n        var casted_keys = data.keys;\r\n        var casted_values = data.series;\r\n        var aggregate_data = data.data;\r\n        var newValuesConfig = data.seriesConfig;\r\n\r\n        option.kpiValue = aggregate_data.length > 0 ? aggregate_data[0][0] : 'N/A';\r\n        if (config.values[0].format) {\r\n            option.kpiValue = numbro(option.kpiValue).format(config.values[0].format);\r\n        }\r\n        option.kpiName = config.values[0].name;\r\n        option.style = config.values[0].style;\r\n        option.edit = this.translate.instant(\"COMMON.EDIT\");\r\n        option.refresh = this.translate.instant(\"COMMON.REFRESH\");\r\n        return option;\r\n    };\r\n}"]}